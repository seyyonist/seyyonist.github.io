(this.webpackJsonpcsv_to_tally=this.webpackJsonpcsv_to_tally||[]).push([[0],{12:function(e,t,a){},13:function(e,t,a){},14:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(2),E=a.n(l),c=(a(12),a(3)),o=a(4),i=a(6),u=a(5),s=(a(13),a(16));function d(e,t){var a="<"+t+">";for(var n in e)a+="<"+n+">",a+=e[n],a+="</"+n+">";return a=(a=a.replace(/<\/?[0-9]{1,}>/g,""))+"</"+t+">"}function m(e){var t="";for(var a in e)t+="<"+a+">",t+=e[a],t+="</"+a+">";return t=t.replace(/<\/?[0-9]{1,}>/g,"")}var v=function(e){Object(i.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(e=t.call.apply(t,[this].concat(r))).state={csvString:"",xml:"",dataList:[],selectedFile:""},e}return Object(o.a)(a,[{key:"openFile",value:function(){this.refs.fileSelector.click()}},{key:"readInputFile",value:function(e){var t=this,a=new FileReader,n=e.target.files[0].name;a.readAsText(e.target.files[0],"UTF-8"),a.onload=function(){var e=a.result.trim();t.setState({csvString:e})},this.setState({selectedFile:n})}},{key:"processCSV",value:function(){var e=this.state.csvString.split("\n"),t=[];if(console.debug(e),Array.isArray(e)){for(var a=1;a<e.length;a++){console.debug(e[a]);var n=e[a].split(",");if(Array.isArray(n)){var r={date:n[0],vtype:n[1],refNo:n[2],drLed:n[3],crLed:n[4],amt:n[5],narration:n[6]};t.push(r)}}this.setState({dataList:t})}else alert("invalid data")}},{key:"generateXML",value:function(){var e=this.state.dataList,t="<ENVELOPE><HEADER><TALLYREQUEST>Import Data</TALLYREQUEST></HEADER><BODY><IMPORTDATA><REQUESTDESC><REPORTNAME>Vouchers</REPORTNAME><STATICVARIABLES><SVCURRENTCOMPANY></SVCURRENTCOMPANY></STATICVARIABLES></REQUESTDESC><REQUESTDATA>";e.forEach((function(e,a){var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:123234,a=Object(s.a)(),n={REMOVEZEROENTRIES:"No",ISDEEMEDPOSITIVE:"No",LEDGERNAME:e.crLed,AMOUNT:e.amt},r={REMOVEZEROENTRIES:"No",ISDEEMEDPOSITIVE:"Yes",LEDGERNAME:e.drLed,AMOUNT:-e.amt},l={VOUCHERTYPENAME:e.vtype,DATE:e.date,EFFECTIVEDATE:e.date,REFERENCE:e.refNo,NARRATION:e.narration,GUID:a,ALTERID:t},E=m(l),c=d(n,"ALLLEDGERENTRIES.LIST"),o=d(r,"ALLLEDGERENTRIES.LIST"),i='<VOUCHER REMOTEID="'+a+'" VCHTYPE="'+e.vtype+'" ACTION="Create">',u='<TALLYMESSAGE xmlns:UDF="TallyUDF">'+i+E+c+o+"</VOUCHER></TALLYMESSAGE>";return u}(e,a);t+=n})),t+="</REQUESTDATA></IMPORTDATA></BODY></ENVELOPE>",this.setState({xml:t})}},{key:"OBJtoXML",value:function(e,t){var a="<"+t+">";for(var n in e)a+="<"+n+">",a+=e[n],a+="</"+n+">";return a=(a=a.replace(/<\/?[0-9]{1,}>/g,""))+"</"+t+">"}},{key:"render",value:function(){var e=this,t=this.state.dataList.map((function(e,t){return r.a.createElement("tr",{key:t},r.a.createElement("td",null,e.date),r.a.createElement("td",null,e.vtype),r.a.createElement("td",null,e.refNo),r.a.createElement("td",null,e.drLed),r.a.createElement("td",null,e.crLed),r.a.createElement("td",null,e.amt),r.a.createElement("td",null,e.narration))}));return r.a.createElement("div",null,r.a.createElement("input",{type:"file",id:"chooseFile",ref:"fileSelector",onChange:this.readInputFile.bind(this),onClick:function(e){e.target.value=null},style:{display:"none"}}),r.a.createElement("button",{onClick:function(){return e.openFile()}},"Open File"),r.a.createElement("button",{onClick:function(){return e.processCSV()}},"Process CSV"),r.a.createElement("button",{onClick:function(){return e.generateXML()}},"Generate XML"),r.a.createElement("hr",null),r.a.createElement("div",null,"Selected file : ",this.state.selectedFile),r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"Date"),r.a.createElement("th",null,"Voucher Type"),r.a.createElement("th",null,"Ref Number"),r.a.createElement("th",null,"Dr Ledger"),r.a.createElement("th",null,"Cr Ledger"),r.a.createElement("th",null,"Amount"),r.a.createElement("th",null,"narration"))),r.a.createElement("tbody",null,t)),r.a.createElement("hr",null),r.a.createElement("div",null,r.a.createElement("textarea",{readOnly:!0,value:this.state.xml,rows:"15",cols:"150"})))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));E.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(v,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},7:function(e,t,a){e.exports=a(14)}},[[7,1,2]]]);
//# sourceMappingURL=main.9d548682.chunk.js.map