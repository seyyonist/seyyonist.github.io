(this.webpackJsonpcsv_to_tally=this.webpackJsonpcsv_to_tally||[]).push([[0],{13:function(e,t,a){},14:function(e,t,a){},16:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(2),o=a.n(r),s=(a(13),a(3)),c=a(4),i=a(7),E=a(6),u=(a(14),a(18));function m(e,t){var a="<"+t+">";for(var n in e)a+="<"+n+">",a+=e[n],a+="</"+n+">";return a=(a=a.replace(/<\/?[0-9]{1,}>/g,""))+"</"+t+">"}function d(e){var t="";for(var a in e)t+="<"+a+">",t+=e[a],t+="</"+a+">";return t=t.replace(/<\/?[0-9]{1,}>/g,"")}var v=a(5),h=function(e){return l.a.createElement("div",{id:"results",className:"results",style:{display:e.show?"block":"none"}},l.a.createElement("div",{className:"header"},l.a.createElement("button",{onClick:function(){return e.toggle()},className:"btn btn-sm btn-danger"},"close")),l.a.createElement("div",{className:"body"},e.value))},b=function(e){Object(i.a)(a,e);var t=Object(E.a)(a);function a(){var e;Object(s.a)(this,a);for(var n=arguments.length,l=new Array(n),r=0;r<n;r++)l[r]=arguments[r];return(e=t.call.apply(t,[this].concat(l))).state={csvString:"",xml:"",dataList:[],selectedFile:"",showResult:!1},e}return Object(c.a)(a,[{key:"openFile",value:function(){this.refs.fileSelector.click()}},{key:"readInputFile",value:function(e){var t=this,a=new FileReader,n=e.target.files[0].name;a.readAsText(e.target.files[0],"UTF-8"),a.onload=function(){var e=a.result.trim();t.setState({csvString:e})},this.setState({selectedFile:n})}},{key:"processCSV",value:function(){var e=this.state.csvString.split("\n"),t=[];if(console.debug(e),Array.isArray(e)){for(var a=1;a<e.length;a++){console.debug(e[a]);var n=e[a].split(",");if(Array.isArray(n)){var l={date:n[0],vtype:n[1],refNo:n[2],drLed:n[3],crLed:n[4],amt:n[5],narration:n[6]};t.push(l)}}this.setState({dataList:t})}else alert("invalid data")}},{key:"generateXML",value:function(){var e=this.state.dataList,t="<ENVELOPE><HEADER><TALLYREQUEST>Import Data</TALLYREQUEST></HEADER><BODY><IMPORTDATA><REQUESTDESC><REPORTNAME>Vouchers</REPORTNAME><STATICVARIABLES><SVCURRENTCOMPANY></SVCURRENTCOMPANY></STATICVARIABLES></REQUESTDESC><REQUESTDATA>";e.forEach((function(e,a){var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:123234,a=Object(u.a)(),n={REMOVEZEROENTRIES:"No",ISDEEMEDPOSITIVE:"No",LEDGERNAME:e.crLed,AMOUNT:e.amt},l={REMOVEZEROENTRIES:"No",ISDEEMEDPOSITIVE:"Yes",LEDGERNAME:e.drLed,AMOUNT:-e.amt},r={VOUCHERTYPENAME:e.vtype,DATE:e.date,EFFECTIVEDATE:e.date,REFERENCE:e.refNo,NARRATION:e.narration,GUID:a,ALTERID:t},o=d(r),s=m(n,"ALLLEDGERENTRIES.LIST"),c=m(l,"ALLLEDGERENTRIES.LIST"),i='<VOUCHER REMOTEID="'+a+'" VCHTYPE="'+e.vtype+'" ACTION="Create">',E='<TALLYMESSAGE xmlns:UDF="TallyUDF">'+i+o+s+c+"</VOUCHER></TALLYMESSAGE>";return E}(e,a);t+=n}));v(t+="</REQUESTDATA></IMPORTDATA></BODY></ENVELOPE>");this.setState({xml:t,showResult:!0})}},{key:"OBJtoXML",value:function(e,t){var a="<"+t+">";for(var n in e)a+="<"+n+">",a+=e[n],a+="</"+n+">";return a=(a=a.replace(/<\/?[0-9]{1,}>/g,""))+"</"+t+">"}},{key:"toggleResult",value:function(){var e=this.state.showResult;this.setState({showResult:!e})}},{key:"render",value:function(){var e=this,t=this.state.dataList.map((function(e,t){return l.a.createElement("tr",{key:t},l.a.createElement("td",null,e.date),l.a.createElement("td",null,e.vtype),l.a.createElement("td",null,e.refNo),l.a.createElement("td",null,e.drLed),l.a.createElement("td",null,e.crLed),l.a.createElement("td",null,e.amt),l.a.createElement("td",null,e.narration))}));return l.a.createElement("div",null,l.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light"},l.a.createElement("a",{className:"navbar-brand",href:"#"},"Voucher to tally XML "),l.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarColor03","aria-controls":"navbarColor03","aria-expanded":"false","aria-label":"Toggle navigation"},l.a.createElement("span",{className:"navbar-toggler-icon"})),l.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarColor03"},l.a.createElement("ul",{className:"navbar-nav mr-auto"}))),l.a.createElement("div",{className:"container-fluid"},l.a.createElement("input",{type:"file",id:"chooseFile",ref:"fileSelector",onChange:this.readInputFile.bind(this),onClick:function(e){e.target.value=null},style:{display:"none"}}),l.a.createElement("div",{className:"bg-info pl-2 pr-2 pb-1 pt-1 text-dark"},"Selected file :",l.a.createElement("button",{onClick:function(){return e.openFile()},type:"button",className:"btn btn-sm btn-primary"},"Open File")," : ",this.state.selectedFile,"\xa0",l.a.createElement("button",{onClick:function(){return e.processCSV()},type:"button",className:"btn btn-sm btn-success"},"Process CSV"),l.a.createElement("button",{type:"button",className:"btn btn-sm btn-warning float-right",onClick:function(){return e.generateXML()}},"Generate XML")),l.a.createElement("table",{className:"table table-hover"},l.a.createElement("thead",null,l.a.createElement("tr",null,l.a.createElement("th",null,"Date"),l.a.createElement("th",null,"Voucher Type"),l.a.createElement("th",null,"Ref Number"),l.a.createElement("th",null,"Dr Ledger"),l.a.createElement("th",null,"Cr Ledger"),l.a.createElement("th",null,"Amount"),l.a.createElement("th",null,"narration"))),l.a.createElement("tbody",null,t)),l.a.createElement("hr",null),l.a.createElement(h,{value:this.state.xml,show:this.state.showResult,toggle:function(){return e.toggleResult()}})))}}]),a}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(b,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},8:function(e,t,a){e.exports=a(16)}},[[8,1,2]]]);
//# sourceMappingURL=main.b55ad33d.chunk.js.map